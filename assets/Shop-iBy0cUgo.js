import{r as t,u as K,j as e,c as Q,A as Z,P as m,b as U,d as _,M as b,n as ee,R as P,e as N,B as u,g as se,x as ae,C as y,S as ne,H as re,f as te,F as v,y as ie,z as A,s as H}from"./index-BJHwLESq.js";import{I,Q as le}from"./QuantityButton-QEYobsje.js";import{P as D}from"./ProductCard-CG6pXfZF.js";import{C as p,f as B}from"./format-DZo1QkM2.js";const G=t.forwardRef(({bsPrefix:x,active:i=!1,children:l,className:c,as:d="li",linkAs:h=Z,linkProps:j={},href:o,title:s,target:a,...g},r)=>{const f=K(x,"breadcrumb-item");return e.jsx(d,{ref:r,...g,className:Q(f,c,{active:i}),"aria-current":i?"page":void 0,children:i?l:e.jsx(h,{...j,href:o,title:s,target:a,children:l})})});G.displayName="BreadcrumbItem";const J=t.forwardRef(({bsPrefix:x,className:i,listProps:l={},children:c,label:d="breadcrumb",as:h="nav",...j},o)=>{const s=K(x,"breadcrumb");return e.jsx(h,{"aria-label":d,className:i,ref:o,...j,children:e.jsx("ol",{...l,className:Q(s,l==null?void 0:l.className),children:c})})});J.displayName="Breadcrumb";const w=Object.assign(J,{Item:G}),V=({id:x,shopId:i,image:l,alt:c,onClose:d})=>{const h=U(),{products:j,isLoading:o}=_(),s=t.useMemo(()=>(j??[]).filter(a=>{var g;return a.id!==x&&((g=a.shop)==null?void 0:g.id)===i}).slice(0,4),[j,x,i]);return e.jsxs(b,{show:!0,onHide:d,centered:!0,size:"lg",backdrop:"static","aria-labelledby":"cart-popup-title",children:[e.jsx(b.Header,{closeButton:!0,children:e.jsxs(b.Title,{id:"cart-popup-title",className:"d-flex align-items-center gap-2",children:[e.jsx(ee,{className:"text-success fs-4"}),"Produk ditambahkan"]})}),e.jsxs(b.Body,{children:[e.jsxs(P,{className:"align-items-center gy-3",children:[e.jsx(N,{sm:"auto",children:e.jsx(I,{src:l,alt:c,rounded:!0,width:80,height:80,loading:"lazy",decoding:"async"})}),e.jsxs(N,{children:[e.jsx("h6",{className:"mb-1",children:c}),e.jsx("p",{className:"text-muted small mb-0",children:"Produk berhasil ditambahkan ke keranjangmu."})]}),e.jsx(N,{sm:"auto",children:e.jsx(u,{variant:"primary",onClick:()=>h("/cart"),children:"Lihat Keranjang"})})]}),!o&&s.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"mb-3",children:"Produk lain dari toko ini"}),e.jsx(D,{products:s,variant:"compact",onProductClick:a=>{d(),h(`/shop/${a.id}`)}})]})]}),e.jsx(b.Footer,{children:e.jsx(u,{variant:"outline-secondary",onClick:d,children:"Lanjutkan Belanja"})})]})};V.propTypes={id:m.oneOfType([m.string,m.number]).isRequired,shopId:m.oneOfType([m.string,m.number]).isRequired,image:m.string.isRequired,alt:m.string.isRequired,onClose:m.func.isRequired};const ue=()=>{var q,L,F,E;const{id:x}=se(),i=Number(x),{products:l,shops:c,isLoading:d,isError:h,refetch:j}=_(),o=U(),s=t.useMemo(()=>l.find(n=>n.id===i),[i,l]),a=t.useMemo(()=>s?c.find(n=>n.id===s.shop.id)??s.shop:null,[s,c]),g=t.useMemo(()=>s?l.filter(n=>{var k,O;return n.id!==s.id&&((k=n.shop)==null?void 0:k.id)===((O=s.shop)==null?void 0:O.id)}).slice(0,8):[],[s,l]),r=t.useMemo(()=>ae(i),[i]),[f,T]=t.useState((r==null?void 0:r.quantity)??1),[C,R]=t.useState((r==null?void 0:r.note)??""),[$,M]=t.useState(((q=s==null?void 0:s.images)==null?void 0:q[0])??""),[W,z]=t.useState(!1);t.useEffect(()=>{T((r==null?void 0:r.quantity)??1),R((r==null?void 0:r.note)??"")},[r]),t.useEffect(()=>{var n;(n=s==null?void 0:s.images)!=null&&n.length&&M(s.images[0]),window.scrollTo({top:0,behavior:"smooth"})},[s]);const S=t.useMemo(()=>s?s.price-s.price*(s.discount_percentage/100):0,[s]),X=()=>{s&&(A({productId:s.id,shopId:s.shop.id,quantity:f}),H(s.id,C),z(!0))},Y=()=>z(!1);return d?e.jsx(y,{className:"py-5 text-center",children:e.jsx(ne,{animation:"border",role:"status"})}):h?e.jsxs(y,{className:"py-5 text-center d-flex flex-column align-items-center gap-3",children:[e.jsx("h2",{className:"fw-bold mb-0",children:"Gagal memuat detail produk"}),e.jsx("p",{className:"text-muted",children:"Silakan coba memuat ulang halaman."}),e.jsx(u,{onClick:j,children:"Muat ulang"})]}):s?e.jsxs("main",{children:[e.jsxs(re,{children:[e.jsx("title",{children:`${s.title} - ${(a==null?void 0:a.name)??"Toko"}`}),e.jsx("meta",{name:"description",content:`Belanja ${s.title} dengan diskon ${s.discount_percentage}% di ${a==null?void 0:a.name}.`})]}),e.jsxs(y,{className:"py-4",children:[e.jsxs(w,{className:"mb-4",children:[e.jsx(w.Item,{href:"/",children:"Beranda"}),e.jsx(w.Item,{href:`/search/${encodeURIComponent((a==null?void 0:a.name)??"shop")}`,children:(a==null?void 0:a.name)??"Toko"}),e.jsx(w.Item,{active:!0,children:s.title})]}),e.jsxs(P,{className:"g-5",children:[e.jsxs(N,{lg:6,children:[e.jsx(p,{className:"border-0 shadow-sm mb-3",children:e.jsx(I,{src:$,alt:s.title,className:"img-fluid rounded",loading:"lazy",decoding:"async"})}),e.jsx(P,{className:"g-3",children:(L=s.images)==null?void 0:L.map((n,k)=>e.jsx(N,{xs:4,sm:3,children:e.jsx(u,{variant:$===n?"primary":"outline-secondary",className:"w-100 p-2",onClick:()=>M(n),children:e.jsx(I,{src:n,alt:`${s.title} ${k+1}`,className:"img-fluid rounded",loading:"lazy",decoding:"async"})})},n))}),e.jsx(p,{className:"border-0 bg-light shadow-sm mt-4",children:e.jsxs(p.Body,{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-3 text-start",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"fw-semibold mb-1",children:a==null?void 0:a.name}),e.jsx("p",{className:"text-muted small mb-0",children:"Mitra resmi dengan ulasan terbaik."})]}),e.jsx(u,{variant:"outline-primary",size:"sm",className:"ms-sm-auto",onClick:()=>o(`/search/${encodeURIComponent((a==null?void 0:a.name)??"")}`),children:"Kunjungi Toko"})]})})]}),e.jsx(N,{lg:6,children:e.jsx(p,{className:"border-0 shadow-sm",children:e.jsxs(p.Body,{className:"d-flex flex-column gap-4",children:[e.jsxs("div",{children:[e.jsxs(te,{bg:"success",className:"mb-2",children:[s.discount_percentage,"% OFF"]}),e.jsx(p.Title,{className:"h2 fw-bold",children:s.title}),e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("span",{className:"fs-3 fw-bold text-primary",children:B(S)}),e.jsx("span",{className:"text-muted text-decoration-line-through",children:B(s.price)})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"fw-semibold",children:"Deskripsi"}),e.jsx("p",{className:"text-muted mb-0",children:s.description})]}),e.jsx(p,{className:"bg-light border-0",children:e.jsxs(p.Body,{className:"d-flex flex-column flex-sm-row align-items-sm-center gap-3",children:[e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("span",{className:"text-muted",children:"Jumlah"}),e.jsx(le,{productId:s.id,value:f,persist:!1,onQuantityChange:T})]}),e.jsxs("div",{className:"ms-sm-auto",children:[e.jsx("span",{className:"text-muted small",children:"Subtotal"}),e.jsx("div",{className:"fs-5 fw-semibold text-primary",children:B(S*f)})]})]})}),e.jsxs(v.Group,{className:"mb-0",children:[e.jsx(v.Label,{children:"Catatan untuk penjual"}),e.jsx(v.Control,{as:"textarea",rows:3,placeholder:"Contoh: warna hitam, size M",value:C,onChange:n=>R(n.target.value),maxLength:200}),e.jsx(v.Text,{muted:!0,children:"Opsional, maksimal 200 karakter."})]}),e.jsxs("div",{className:"d-flex flex-column flex-sm-row gap-3",children:[e.jsxs(u,{size:"lg",className:"flex-grow-1 d-flex align-items-center justify-content-center gap-2",onClick:X,children:[e.jsx(ie,{}),"Tambah ke Keranjang"]}),e.jsx(u,{variant:"outline-secondary",size:"lg",className:"flex-grow-1",onClick:()=>{A({productId:s.id,shopId:s.shop.id,quantity:f}),H(s.id,C),o("/cart")},children:"Beli Langsung"})]})]})})})]}),g.length>0&&e.jsxs("section",{className:"mt-5",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-end mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"h4 mb-0",children:["Produk lain dari ",a==null?void 0:a.name]}),e.jsx("p",{className:"text-muted mb-0",children:"Temukan produk populer lain dari toko ini."})]}),e.jsx(u,{variant:"link",className:"text-decoration-none",onClick:()=>o(`/search/${encodeURIComponent((a==null?void 0:a.name)??"")}`),children:"Lihat semua"})]}),e.jsx(D,{products:g,variant:"compact"})]})]}),W&&e.jsx(V,{id:s.id,shopId:s.shop.id,image:((F=s.images)==null?void 0:F[1])??((E=s.images)==null?void 0:E[0]),alt:s.title,onClose:Y})]}):e.jsxs(y,{className:"py-5 text-center",children:[e.jsx("h2",{className:"fw-bold mb-3",children:"Produk tidak ditemukan"}),e.jsx("p",{className:"text-muted",children:"Produk yang kamu cari mungkin sudah tidak tersedia."}),e.jsx(u,{href:"/",variant:"primary",children:"Kembali ke beranda"})]})};export{ue as default};
